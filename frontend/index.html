<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>SQL-Agent demo</title>
  <style>
    body       { font-family: system-ui, sans-serif; margin: 2rem 4rem; }
    h1         { margin-top: 0; }
    textarea   { width: 100%; height: 160px; font: 14px monospace; }
    input[type=text] { width: 100%; padding: .4rem; }
    pre {
      background: #111; color: #6fef8e; padding: 1rem;
      overflow-x: auto; white-space: pre-wrap; word-break: break-all;
    }
    .muted { color:#777; font-size:.9rem }
  </style>
</head>
<body>

<h1>SQL-Agent demo</h1>

<form id="form">

  <label><strong>Question / SQL instruction</strong></label><br>
  <textarea id="question" required>
How many tables are in the DB?
  </textarea><br><br>

  <label>
    <input type="radio" name="mode" value="/ask" checked>
    <span>/ask (read-only)</span>
  </label>
  &nbsp;&nbsp;
  <label>
    <input type="radio" name="mode" value="/edit">
    <span>/edit (write)</span>
  </label><br><br>

  <label class="muted">Write-token (only required for /edit)</label><br>
  <input type="text" id="token" placeholder="paste WRITE_TOKEN from .env"><br><br>

  <button id="sendBtn" type="submit">Send</button>
</form>

<h2>Response →</h2>
<pre id="output">{ waiting }</pre>


<!-- ────────────────────────────────────────────────────────────── -->
<!-- Very small JS helper                                           -->
<!-- ────────────────────────────────────────────────────────────── -->
<script>
const form   = document.getElementById('form');
const output = document.getElementById('output');

form.addEventListener('submit', async (e) => {
  e.preventDefault();

  // pick values
  const question   = document.getElementById('question').value.trim();
  const endpoint   = document.querySelector('input[name=mode]:checked').value;
  const writeToken = document.getElementById('token').value.trim();

  if (!question) {
    output.textContent = '⚠️  Please enter a question.';
    return;
  }

  try {
    const res = await fetch(endpoint, {
      method : 'POST',                          // ✅ must be POST
      headers: {
        'Content-Type': 'application/json',
        ...(endpoint === '/edit' && writeToken && {'X-Token': writeToken})
      },
      body: JSON.stringify({ question })
    });

    const text = await res.text();
    output.textContent = `HTTP ${res.status}\n\n${text}`;
  } catch (err) {
    output.textContent = `Client error → ${err}`;
  }
});
</script>

</body>
</html>
